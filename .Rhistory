meanHos=mean(住院天數))
group_by(DiagSumS,.dots=list(院區,性別)) %>%
summarise(nRecord=n(),
meanAge=mean(年齡),
meanHos=mean(住院天數))
group_by(DiagSumS,.dots=c("院區","性別")) %>%
summarise(nRecord=n(),
meanAge=mean(年齡),
meanHos=mean(住院天數))
group_by_(DiagSumS,.dots=c("院區","性別")) %>%
summarise(nRecord=n(),
meanAge=mean(年齡),
meanHos=mean(住院天數))
dots <- lapply(c("院區","性別"), as.symbol)
group_by(DiagSumS,.dots=dots) %>%
summarise(nRecord=n(),
meanAge=mean(年齡),
meanHos=mean(住院天數))
dots <- lapply(c("院區","性別"), as.symbol)
group_by(DiagSumS,.dots=dots) %>%
summarise(nRecord=n(),
meanAge=mean(年齡),
meanHos=mean(住院天數))
dots
df <-  data.frame(
asihckhdoydk = sample(LETTERS[1:3], 100, replace=TRUE),
a30mvxigxkgh = sample(LETTERS[1:3], 100, replace=TRUE),
value = rnorm(100)
)
# Columns you want to group by
grp_cols <- names(df)[-3]
# Convert character vector to list of symbols
dots <- lapply(grp_cols, as.symbol)
dots
group_by_(DiagSumS,.dots=dots) %>%
summarise(nRecord=n(),
meanAge=mean(年齡),
meanHos=mean(住院天數))
dots <- lapply(c("院區","性別"), as.symbol)
group_by_(DiagSumS,.dots=dots) %>%
summarise(nRecord=n(),
meanAge=mean(年齡),
meanHos=mean(住院天數))
DiagSumE <- rename(DiagSumS, Hosp = 院區,Gender=性別)
group_by_(DiagSumE,Hosp,Gender) %>%
summarise(nRecord=n(),
meanAge=mean(年齡),
meanHos=mean(住院天數))
group_by(DiagSumE,Hosp,Gender) %>%
summarise(nRecord=n(),
meanAge=mean(年齡),
meanHos=mean(住院天數))
arrange(DiagSumS,
desc(住院天數),
desc(年齡))
group_by(DiagSumE,Hosp,Gender) %>%
summarise(nRecord=n(),
meanAge=mean(年齡),
meanHos=mean(住院天數)) %>%
arrange(desc(meanHos))
DiagSumE[1:5,1:2]
arrange(DiagSumS,住院天數) %>% select(院區,住院天數)
arrange1<-arrange(DiagSumS,住院天數) %>% select(院區,住院天數)
1+1
1+1
2+2
1+1
1+1
2+2
3+3
4+4
5+5+
5
6+6
6+6
6+
?mean
?seq
seq(2,20,2)
a[4]
a<-1:10
a[4]
b[c(5,6,7)]
b<-seq(2,20,2)
b[c(5,6,7)]
a<-1:10
b<-seq(2,10,2)
a+b
a<-c(1,2,3)
b<-c(1,2)
a+b
library(readr)
BasicS <- read_csv("C:/Users/yjtseng/Dropbox/CGU/CGMH_R/BasicS.csv")
View(BasicS)
View(BasicS)
EMDiagS <- read_csv("EMDiagS.csv") #自行載入
class(EMDiagS$資料年月)
as.character(EMDiagS$資料年月)
class(EMDiagS$資料年月)
install.packages("lumbirdate")
EMDiagS$資料年月
class(EMDiagS$資料年月)
library(lubridate)
EMDiagS$資料年月
class(EMDiagS$資料年月)
EMDiagS$輸入日期
class(EMDiagS$輸入日期)
EMDiagS$輸入日期
class(EMDiagS$輸入日期)
ymd(EMDiagS$輸入日期)
EMDiagS$輸入日期
class(EMDiagS$輸入日期)
EMDiagS$輸入日期<-ymd(EMDiagS$輸入日期)
class(EMDiagS$輸入日期)
weekdays(EMDiagS$輸入日期)
grep("250",EMDiagS)
grep("250",EMDiagS$疾病碼)
grep("250",EMDiagS$疾病碼,value=T)
grep("250",EMDiagS$疾病碼)
grep("250",EMDiagS$疾病碼,value=T)
grep("^250",EMDiagS$疾病碼,value=T)
grepl("250",EMDiagS$疾病碼)
EMDiagS <- read_csv("EMDiagS.csv")
library(readr)
EMDiagS <- read_csv("EMDiagS.csv")
mean(EMDiagS$資料年齡)
View(EMDiagS)
table(EMDiagS$掛號科別)
mean(EMDiagS$疾病序號)
median(EMDiagS$疾病序號)
table(EMDiagS$掛號科別)
BasicS <- read_csv("BasicS.csv")
DiagSumS <- read_csv("DiagSumS.csv")
quantile(DiagSumS$住院天數)
table(DiagSumS$年齡,DiagSumS$住院天數)
cor(DiagSumS$年齡,DiagSumS$住院天數)
table(DiagSumS$`14天內再次住院註記`,DiagSumS$院區)
table(DiagSumS$院區,DiagSumS$`14天內再次住院註記`)
knitr::kable(filter1 %>% select(院區,來源別,診斷類別1))
knitr::kable(filter1 %>% select(院區,來源別,ends_with("日期")))
summarise(DiagSumS,
nRecord=n(),
nID=n_distinct(歸戶代號),
nSource=n_distinct(來源別))
library(dplyr)
DiagSumS %>% filter(grepl("腫瘤",診斷類別名稱1))
DiagSumS %>% summarise(grepl("腫瘤",診斷類別名稱1))
DiagSumS %>% summarise(sum(grepl("腫瘤",診斷類別名稱1)))
DiagSumS %>% summarise(sum(grepl("腫瘤",診斷類別名稱1)),sum(來源別=="E"))
library(tidyr)
?gather
library(dplyr)
mini_iris <-
iris %>%
group_by(Species) %>%
slice(1)
mini_iris %>% gather(key = flower_att, value = measurement, -Species)
?spread
head(DiagSumS)
head(DiagSumS %>% select(starts_with("診斷類別")),3)
head(DiagSumS %>% select(starts_with("診斷類別"),-contains("名稱")),3)
airqualityM<-gather(DiagWide,診斷類別,診斷碼) ##欄位需要保留"Month","Day"
DiagLong<-gather(DiagWide,診斷類別,診斷碼,-住院號) ##欄位需要保留"Month","Day"
DiagWide<-DiagSumS %>%
select(住院號,starts_with("診斷類別"),-contains("名稱"))
DiagLong<-gather(DiagWide,診斷類別,診斷碼,-住院號)
DiagLong
View(DiagLong)
head(DiagLong %>% arrange(住院號))
library(tableone)
DiagSumS
CreateTableOne(data=DiagSumS,strata = "性別",vars = "年齡")
View(DiagSumS)
CreateTableOne(data=DiagSumS,strata = "性別",vars = c("年齡","14天內再次住院註記"))
CreateTableOne(data=DiagSumS,strata = "性別",vars = c("年齡","`14天內再次住院註記`"))
CreateTableOne(data=DiagSumS,strata = "性別",vars = c("年齡","來源別"))
CreateTableOne(data=DiagSumS,strata = "性別",vars = c("年齡","來源別","住院天數"))
?chisq.test
chisq.test(table(DiagSumS$院區,
DiagSumS$`14天內再次住院註記`))
chisq.test(table(DiagSumS$院區,
DiagSumS$`14天內再次住院註記`))
table(DiagSumS$院區,
DiagSumS$`14天內再次住院註記`)
t.test(`14天內再次住院註記`~住院天數,DiagSumS)
t.test(住院天數~`14天內再次住院註記`,DiagSumS)
CreateTableOne(data=DiagSumS,strata = "性別",vars = c("年齡","來源別","住院天數"))
?CreateTableOne
print(t1, quote = TRUE, noSpaces = TRUE)
t1<-CreateTableOne(data=DiagSumS,
strata = "性別",
vars = c("年齡","來源別","住院天數"))
print(t1, quote = TRUE, noSpaces = TRUE)
DiagSumS$年齡
```
?cut
cut(DiagSumS$年齡,breaks = c(18,65))
summary(DiagSumS$年齡)
cut(DiagSumS$年齡,breaks = c(50,65))
cut(DiagSumS$年齡,breaks = c(50,65),labels = c("<=50","50~65",">65"))
cut(DiagSumS$年齡,breaks = c(18,50,65),labels = c("<=50","50~65",">65"))
cut(DiagSumS$年齡,breaks = c(50,65),labels = c("<=50","50~65",">65"))
cut(DiagSumS$年齡,breaks = c(0,50,65),labels = c("<=50","50~65",">65"))
cut(DiagSumS$年齡,breaks = c(0,50,65))
summary(DiagSumS$年齡)
cut(DiagSumS$年齡,breaks = c(0,50,65,100))
cut(DiagSumS$年齡,breaks = c(0,50,65,100),labels = 1:4)
cut(DiagSumS$年齡,breaks = c(0,50,65,100),labels = c("<=50","50-65",">65"))
table(DiagSumS$AgeGroup)
DiagSumS$AgeGroup<-
cut(DiagSumS$年齡,
breaks = c(0,50,65,100),
labels = c("<=50","50-65",">65"))
table(DiagSumS$AgeGroup)
summary(DiagSumS$居住地)
table(DiagSumS$居住地)
DiagSumS$ResGroup<-""
DiagSumS$ResGroup[grepl("台北|基隆|苗栗|桃園|新北市|新竹",DiagSumS$居住地)] <- "北"
DiagSumS$ResGroup[grepl("台中|雲林|彰化",DiagSumS$居住地)] <- "中"
DiagSumS$ResGroup[grepl("高雄|嘉義|屏東|台南",DiagSumS$居住地)] <- "南"
DiagSumS$ResGroup[grepl("臺東|宜蘭",DiagSumS$居住地)] <- "東"
table(DiagSumS$ResGroup)
library(icd)
icd_comorbid_ahrq？
?icd_comorbid_ahrq
icd_comorbid_ahrq(DiagSumS$診斷類別1)
icd_comorbid_ahrq(DiagSumS %>% rename(visit_name=住院號,icd_name=診斷類別1))
AHRQ<-icd_comorbid_ahrq(DiagSumS %>% rename(visit_name=住院號,icd_name=診斷類別1))
View(AHRQ)
head(AHRQ)
View(DiagSumS)
icd_guess_version(
"1196"
)
icd_guess_version(
"1196"
)
icd_comorbid_ahrq
?icd_comorbid_ahrq
AHRQ<-
icd10_comorbid_ahrq(
DiagSumS %>% filter(住院日期>20160101) %>%
rename(visit_name=住院號,icd_name=診斷類別1))
View(AHRQ)
DiagSumS %>% filter(住院日期>20160101)
DiagSumS %>% filter(住院日期>20160101) %>% select(診斷類別1)
DiagSumS %>% filter(住院日期>20160101) %>% select(診斷類別1) %>% arrange(診斷類別1)
icd_short_to_decimal(DiagSumS$診斷類別1)
iris[c(F,T),ncol(iris)]
iris[c(F,T),(ncol(iris)-1):ncol(iris)]
ncol(iris)
iris$Species
library(readr)
EMDiagS <- read_csv("EMDiagS.csv") #自行載入
EMDiagS[grepl("^250",EMDiagS$疾病碼),]
EMDiagS[EMDiagS$疾病碼=="25000",]
EM25000<-EMDiagS[EMDiagS$疾病碼=="25000",]
EM250<-EMDiagS[grepl("^250",EMDiagS$疾病碼),]
View(EM250)
View(EM25000)
EMDiagS$疾病碼=="25000"
View(EM25000)
EM250<-
EMDiagS[grepl("^250",EMDiagS$疾病碼),]
?grep
OptDiagS <- read_csv("OptDiagS.csv")
OptOrderS <- read_csv("OptOrderS.csv")
inner_join(OptDiagS,OptOrderS,by=c("歸戶代號","門診號"))
library(dplyr)
inner_join(OptDiagS,OptOrderS,by=c("歸戶代號","門診號"))
test<-inner_join(OptDiagS,OptOrderS,by=c("歸戶代號","門診號"))
View(test)
View(OptDiagS)
View(OptOrderS)
inner_join(OptDiagS,
OptOrderS,
by=c("歸戶代號","門診號"))
joined<-inner_join(OptDiagS,
OptOrderS,
by=c("歸戶代號","門診號"))
View(joined)
DiagSumS
DiagSumS <- read_csv("DiagSumS.csv")
DiagSumS$性別
filter(DiagSumS,性別=="M"&居住地=="高雄市")
DiagSumS$居住地
filter1<-filter(DiagSumS,性別=="M"&居住地=="高雄市")
select(filter1,性別,starts_with("診斷類別"),住院天數,住院日期)
filter1<-
filter(DiagSumS,
性別=="M"&居住地=="高雄市")
select1<-
select(filter1,
性別,
starts_with("診斷類別"),
住院天數,住院日期)
View(filter1)
View(select1)
summarise(filter1,
nE=sum(來源別=="E"),
nTu=sum(grepl("腫瘤",診斷類別名稱1)))
filter1<-
filter(DiagSumS,住院天數>30)
summarise(filter1,
nE=sum(來源別=="E"),
nTu=sum(grepl("腫瘤",診斷類別名稱1)))
filter1<-
filter(DiagSumS,住院天數>30)
summarise(filter1,
nE=sum(來源別=="E"),
nTu=sum(grepl("腫瘤",診斷類別名稱1)))
filter1
summarise(filter1,
nE=sum(來源別=="E"),
nTu=sum(grepl("腫瘤",診斷類別名稱1)))
library(tableone)
install.packages("tableone")
library(readr)
# 讀入疾病統計檔資料，請將檔案放在專案路徑下
DiagSumS <- read_csv("DiagSumS.csv")
#install.packages("tableone")
library(tableone)
t1<-CreateTableOne(data=DiagSumS,
strata = "性別",
vars = c("年齡","來源別","住院天數"))
print(t1, quote = TRUE, noSpaces = TRUE)
library(ggplot2)
ggplot(iris,aes(x=Sepal.Length,y=Sepal.Width))+
geom_point()+facet_grid(.~Species)
ggplot(iris,
aes(x=Sepal.Length,y=Sepal.Width))+
geom_point()+facet_grid(.~Species)
ggplot(iris,
aes(x=Species,y=Sepal.Width))+
geom_boxplot()
twmap <- get_map(
location = 'Taoyuan',
zoom = 11,
language = "zh-TW")
library(ggmap)
install.packages("ggmap")
library(ggmap)
twmap <- get_map(
location = 'Taoyuan',
zoom = 11,
language = "zh-TW")
ggmap(twmap)+
geom_point(aes(x=121.389539,
y=25.035225),
color="red")
library(dplyr)
DiagSumHM <- DiagSumS %>% rename(Dept=住院科別) %>%
group_by(Dept,Year) %>%
summarise(HosStay=mean(住院天數),N=n())
DiagSumS <- read_csv("DiagSumS.csv")
DiagSumS$Year<-substr(DiagSumS$住院日期,1,4)
head(
DiagSumS[,c("住院科別","住院日期","住院天數","Year")])
DiagSumHM <- DiagSumS %>% rename(Dept=住院科別) %>%
group_by(Dept,Year) %>%
summarise(HosStay=mean(住院天數),N=n())
DeptList<-DiagSumHM[DiagSumHM$N>10,]$Dept
DiagSumHM<-DiagSumHM %>%
filter(Dept %in% DeptList)
head(DiagSumHM)
DeptList
DeptList
head(DiagSumHM)
DiagSumHM
low = "white",high = "steelblue") +
theme_bw()
ggplot(DiagSumHM, aes(Year, Dept)) +
geom_tile(aes(fill = HosStay),
colour = "white")+
scale_fill_gradient(
low = "white",high = "steelblue") +
theme_bw()
ggplot(DiagSumHM, aes(Year, Dept)) +
geom_tile(aes(fill = HosStay),
colour = "white")+
scale_fill_gradient(
low = "white",high = "steelblue")
ggplot(DiagSumHM, aes(Year, Dept)) +
geom_tile(aes(fill = HosStay))+
scale_fill_gradient(
low = "white",high = "steelblue")
ggplot(DiagSumHM, aes(Year, Dept)) +
geom_tile(aes(fill = HosStay),
colour = "white")+
scale_fill_gradient(
low = "white",high = "steelblue")
ggplot(DiagSumHM, aes(Year, Dept)) +
geom_tile(aes(fill = HosStay),
colour = "white")
ggplot(DiagSumHM, aes(Year, Dept)) +
geom_tile(aes(fill = HosStay),
colour = "white")+
scale_fill_gradient(
low = "white",high = "steelblue")
ggplot(DiagSumHM, aes(Year, Dept)) +
geom_tile(aes(fill = HosStay))
POLIO_Incidence <-
read_csv("https://raw.githubusercontent.com/CGUIM-BigDataAnalysis/BigDataCGUIM/master/104/POLIO_Incidence.csv")
library(readr)
POLIO_Incidence <-
read_csv("https://raw.githubusercontent.com/CGUIM-BigDataAnalysis/BigDataCGUIM/master/104/POLIO_Incidence.csv")
?gather
library(tidyr)
?gather
POLIO_Incidence
POLIO_Incidence.l<-gather(POLIO_Incidence,key = State,value=Incidence,-YEAR,-WEEK)
POLIO_Incidence.l
POLIO_Incidence.l$Incidence<-gsub("-",NA,POLIO_Incidence.l$Incidence)
POLIO_Incidence.l$Incidence<-as.numeric(POLIO_Incidence.l$Incidence)
ggplot(POLIO_Incidence.l, aes(YEAR, variable)) +
geom_tile(aes(fill = Incidence),
colour = "white")+
scale_fill_gradient(
low = "white",high = "steelblue")
library(ggplot2)
ggplot(POLIO_Incidence.l, aes(YEAR, variable)) +
geom_tile(aes(fill = Incidence),
colour = "white")+
scale_fill_gradient(
low = "white",high = "steelblue")
library(dplyr)
POLIO_Incidence.l.y<-
POLIO_Incidence.l %>% group_by(YEAR,State) %>%
summarize(IncidenceSum=sum(Incidence,na.rm = T))
library(ggplot2)
polioPlot<-ggplot(POLIO_Incidence.l.y, aes(YEAR, State)) +
geom_tile(aes(fill = IncidenceSum),
colour = "white")+
scale_fill_gradient(
low = "white",high = "steelblue") +
theme_minimal()
POLIO_Incidence.l
polioPlot<-ggplot(POLIO_Incidence.l.y, aes(YEAR, State)) +
geom_tile(aes(fill = IncidenceSum),
colour = "white")+
scale_fill_gradient(
low = "white",high = "steelblue") +
theme_minimal()
POLIO_Incidence.l.y
polioPlot
library(readr)
EMDiagS <- read_csv("~/GitHub/CGMH_R/EMDiagS.csv")
View(EMDiagS)
library(readr)
EMDiagS <- read_csv("EMDiagS.csv") #自行載入
View(EMDiagS)
as.numeric("abc")
as.character(EMDiagS$資料年月)
library(readr)
EMDiagS <-
read_csv("~/GitHub/CGMH_R/EMDiagS.csv")
View(EMDiagS)
View(EMDiagS)
class(EMDiagS$輸入日期)
library(lubridate)
ymd('2012/3/3')
library(lubridate)
ymd('2012/3/3')
EMDiagS$輸入日期
ymd(EMDiagS$輸入日期)
ymd(EMDiagS$輸入日期)
class(EMDiagS$輸入日期)
View(iris)
iris$Time<-1
View(iris)
EMDiagS$輸入日期Date<-
ymd(EMDiagS$輸入日期)
class(EMDiagS$輸入日期Date)
class(EMDiagS$輸入日期Date)
grep("A|a",c("Alex","Tom","Amy","Joy","Emma"))
grep("A|a|l|e",c("Alex","Tom","Amy","Joy","Emma"))
grep("A|a|o",c("Alex","Tom","Amy","Joy","Emma"))
EMDiagS$疾病碼
grep("250",EMDiagS$疾病碼)
grepl("250",EMDiagS$疾病碼)
grep("250",EMDiagS$疾病碼)
EMDiagS$疾病碼[62]
EMDiagS$疾病碼[1574]
1:3
1:20
iris[1:10,"Species"]
nrow(iris)
seq(1,nrow(iris),2)
colnames(iris)
EMDiagS$疾病碼=="25000"
EMDiagS[EMDiagS$疾病碼=="25000",]
EMDiagS[EMDiagS$疾病碼=="25000",]
EMDiagS[grep("^250",EMDiagS$疾病碼),]
check<-EMDiagS[grep("^250",EMDiagS$疾病碼),]
View(check)
NameID<-data.frame(Name=c("Tom","Amy","John"),ID=c(1,2,3))
Score<-data.frame(ID=c(1,3),Score=c(90,100))
View(NameID)
View(Score)
library(dplyr)
inner_join(NameID,Score)
full_join(NameID,Score)
semi_join(NameID,Score)
inner_join(NameID,Score)
OptDiagS <- read_csv("OptDiagS.csv")
OptOrderS <- read_csv("OptOrderS.csv")
OptDiagOrder<-inner_join(OptDiagS,OptOrderS,
by=c("歸戶代號","門診號"))
View(OptDiagOrder)
View(OptDiagS)
View(OptOrderS)
table(EMDiagS$掛號科別)
